# TrueSelf16 - éƒ¨ç½²ä¸ç»´æŠ¤æŒ‡å—

> **ç”Ÿäº§ç¯å¢ƒ**: https://trueself16.com  
> **GitHub**: https://github.com/minchenli188-dot/TrueSelfMBTI

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
2. [æœåŠ¡å™¨ä¿¡æ¯](#2-æœåŠ¡å™¨ä¿¡æ¯)
3. [æŠ€æœ¯æ ˆ](#3-æŠ€æœ¯æ ˆ)
4. [é¡¹ç›®ç»“æ„](#4-é¡¹ç›®ç»“æ„)
5. [æœ¬åœ°å¼€å‘](#5-æœ¬åœ°å¼€å‘)
6. [éƒ¨ç½²æ›´æ–°æµç¨‹](#6-éƒ¨ç½²æ›´æ–°æµç¨‹)
7. [æœåŠ¡å™¨ç®¡ç†å‘½ä»¤](#7-æœåŠ¡å™¨ç®¡ç†å‘½ä»¤)
8. [ç¯å¢ƒå˜é‡é…ç½®](#8-ç¯å¢ƒå˜é‡é…ç½®)
9. [API æ¥å£æ¦‚è§ˆ](#9-api-æ¥å£æ¦‚è§ˆ)
10. [æ•…éšœæ’æŸ¥](#10-æ•…éšœæ’æŸ¥)

---

## 1. é¡¹ç›®æ¦‚è¿°

TrueSelf16 æ˜¯ä¸€æ¬¾ AI é©±åŠ¨çš„ MBTI æ€§æ ¼æµ‹è¯„åº”ç”¨ï¼Œé€šè¿‡è‡ªç„¶å¯¹è¯ï¼ˆè€Œéä¼ ç»Ÿé€‰æ‹©é¢˜ï¼‰æ¥æ·±å…¥ç†è§£ç”¨æˆ·æ€§æ ¼ã€‚

### æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½ | æè¿° |
|------|------|
| ğŸ—£ï¸ è‡ªç„¶å¯¹è¯ | åƒå’Œæœ‹å‹èŠå¤©ä¸€æ ·è¿›è¡Œæ€§æ ¼æ¢ç´¢ |
| ğŸ“Š ä¸‰çº§æ·±åº¦ | å¿«é€Ÿ(5é¢˜)ã€æ ‡å‡†(15é¢˜)ã€æ·±åº¦(30é¢˜) |
| ğŸ¨ ä¸“å±ç”»åƒ | AI ç”Ÿæˆ Pop Mart é£æ ¼äººæ ¼è‚–åƒ |
| ğŸ’¬ AI è§£ç­” | æµ‹è¯•åä¸ AI å¯¹è¯è§£ç­”ç–‘é—® |
| ğŸ“ˆ æ¸è¿›å‡çº§ | ä»å¿«é€Ÿæ¨¡å¼æ— ç¼å‡çº§åˆ°æ›´æ·±å±‚åˆ†æ |

### æ”¯æŒçš„ MBTI ç±»å‹

- ğŸŸ£ **åˆ†æå®¶ (NT)**: INTJ, INTP, ENTJ, ENTP
- ğŸŸ¢ **å¤–äº¤å®¶ (NF)**: INFJ, INFP, ENFJ, ENFP
- ğŸ”µ **å®ˆå«è€… (SJ)**: ISTJ, ISFJ, ESTJ, ESFJ
- ğŸŸ¡ **æ¢ç´¢è€… (SP)**: ISTP, ISFP, ESTP, ESFP

---

## 2. æœåŠ¡å™¨ä¿¡æ¯

### AWS Lightsail é…ç½®

| é¡¹ç›® | å€¼ |
|------|-----|
| **å®ä¾‹åç§°** | TrueSelf16 |
| **åŒºåŸŸ** | ap-southeast-1 (æ–°åŠ å¡) |
| **é™æ€ IP** | 18.139.165.168 |
| **æ“ä½œç³»ç»Ÿ** | Ubuntu 24.04 LTS |
| **ç”¨æˆ·å** | ubuntu |

### åŸŸåé…ç½®

| é¡¹ç›® | å€¼ |
|------|-----|
| **åŸŸå** | trueself16.com |
| **DNS æä¾›å•†** | Cloudflare |
| **SSL æ¨¡å¼** | Flexible (Cloudflare å¤„ç† HTTPS) |

### æœåŠ¡ç«¯å£

| æœåŠ¡ | ç«¯å£ | è¯´æ˜ |
|------|------|------|
| Nginx | 80 | å¯¹å¤–ç½‘å…³ï¼Œåå‘ä»£ç† |
| Next.js | 3000 | å‰ç«¯åº”ç”¨ (å†…éƒ¨) |
| FastAPI | 8000 | åç«¯ API (å†…éƒ¨) |

---

## 3. æŠ€æœ¯æ ˆ

### åç«¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| FastAPI | 0.115.6 | Web æ¡†æ¶ |
| Python | 3.11+ | ç¼–ç¨‹è¯­è¨€ |
| SQLAlchemy | 2.0.36 | å¼‚æ­¥ ORM |
| SQLite | - | æ•°æ®åº“ |
| Google Gemini | - | AI æœåŠ¡ |
| Uvicorn | 0.34.0 | ASGI æœåŠ¡å™¨ |

### å‰ç«¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Next.js | 15.1.3 | React æ¡†æ¶ |
| React | 19.0.0 | UI åº“ |
| TypeScript | 5.7.2 | ç±»å‹å®‰å…¨ |
| Tailwind CSS | 3.4.17 | æ ·å¼ |
| Framer Motion | 11.15.0 | åŠ¨ç”» |
| Zustand | 5.0.2 | çŠ¶æ€ç®¡ç† |

### AI æ¨¡å‹

| æ¨¡å‹ | ç”¨é€” |
|------|------|
| gemini-3-flash-preview | å¯¹è¯é—®ç­” (å¿«é€Ÿ) |
| gemini-3-pro-preview | æœ€ç»ˆåˆ†ææŠ¥å‘Š (æ·±åº¦) |
| gemini-3-pro-image-preview | å¤´åƒç”Ÿæˆ |

---

## 4. é¡¹ç›®ç»“æ„

```
TrueSelf16/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ main.py              # FastAPI å…¥å£
â”‚   â”‚   â”œâ”€â”€ config.py            # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ dependencies.py      # ä¾èµ–æ³¨å…¥
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ database.py      # æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ schemas.py       # Pydantic æ¨¡å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ analytics.py     # åˆ†ææ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ analytics_schemas.py
â”‚   â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â”‚   â”œâ”€â”€ chat.py          # èŠå¤© API
â”‚   â”‚   â”‚   â””â”€â”€ analytics.py     # åˆ†æ API
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â”œâ”€â”€ ai_service.py    # AI æœåŠ¡
â”‚   â”‚       â”œâ”€â”€ image_generator.py
â”‚   â”‚       â””â”€â”€ user_insight_extractor.py
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ .env                     # ç¯å¢ƒå˜é‡ (ä¸æäº¤)
â”‚   â””â”€â”€ venv/                    # Python è™šæ‹Ÿç¯å¢ƒ
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx       # æ ¹å¸ƒå±€
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx         # ä¸»é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ providers.tsx    # Context Providers
â”‚   â”‚   â”‚   â””â”€â”€ globals.css      # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ chat/            # èŠå¤©ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ResultView.tsx   # ç»“æœé¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ AIQAView.tsx     # AI é—®ç­”
â”‚   â”‚   â”‚   â””â”€â”€ DepthSelector.tsx
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ useChatSession.ts  # æ ¸å¿ƒèŠå¤©é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ useQASession.ts
â”‚   â”‚   â”‚   â””â”€â”€ useAnalytics.ts
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts           # API å®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â””â”€â”€ utils.ts
â”‚   â”‚   â”œâ”€â”€ context/
â”‚   â”‚   â”‚   â”œâ”€â”€ ThemeContext.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ToastContext.tsx
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚       â””â”€â”€ mbti.ts
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ .env.local               # ç¯å¢ƒå˜é‡ (ä¸æäº¤)
â”‚   â””â”€â”€ node_modules/
â”‚
â”œâ”€â”€ ecosystem.config.js          # PM2 é…ç½®
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â””â”€â”€ DEPLOYMENT_GUIDE.md          # æœ¬æ–‡æ¡£
```

---

## 5. æœ¬åœ°å¼€å‘

### ç¯å¢ƒè¦æ±‚

- Python 3.11+
- Node.js 20+
- pnpm (æ¨è)

### å¯åŠ¨åç«¯

```bash
cd backend
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# åˆ›å»º .env æ–‡ä»¶
echo "GEMINI_API_KEY=your_api_key" > .env

# å¯åŠ¨
uvicorn app.main:app --reload --port 8000
```

### å¯åŠ¨å‰ç«¯

```bash
cd frontend
pnpm install

# åˆ›å»º .env.local
echo "NEXT_PUBLIC_API_URL=http://localhost:8000" > .env.local

# å¯åŠ¨
pnpm dev
```

### æœ¬åœ°è®¿é—®

- å‰ç«¯: http://localhost:3000
- åç«¯ API: http://localhost:8000
- API æ–‡æ¡£: http://localhost:8000/docs

---

## 6. éƒ¨ç½²æ›´æ–°æµç¨‹

### æ ‡å‡†æ›´æ–°æµç¨‹

#### ç¬¬ä¸€æ­¥ï¼šæœ¬åœ°æäº¤ä»£ç 

```bash
cd "/Users/minchenli/Cursor Project/MBTI"
git add .
git commit -m "æè¿°ä½ çš„æ›´æ”¹"
git push
```

#### ç¬¬äºŒæ­¥ï¼šæœåŠ¡å™¨æ‹‰å–å¹¶éƒ¨ç½²

```bash
# SSH è¿æ¥æœåŠ¡å™¨å
cd ~/TrueSelfMBTI
git pull
```

#### ç¬¬ä¸‰æ­¥ï¼šæ ¹æ®æ”¹åŠ¨ç±»å‹æ‰§è¡Œå¯¹åº”å‘½ä»¤

| æ”¹åŠ¨ç±»å‹ | å‘½ä»¤ |
|---------|------|
| **åªæ”¹å‰ç«¯ä»£ç ** | `cd frontend && pnpm build && pm2 restart mbti-frontend` |
| **åªæ”¹åç«¯ä»£ç ** | `pm2 restart mbti-backend` |
| **æ”¹äº†å‰ç«¯ä¾èµ–** | `cd frontend && pnpm install && pnpm build && pm2 restart mbti-frontend` |
| **æ”¹äº†åç«¯ä¾èµ–** | `cd backend && source venv/bin/activate && pip install -r requirements.txt && pm2 restart mbti-backend` |
| **æ”¹äº† Nginx** | `sudo nginx -t && sudo systemctl restart nginx` |

### ä¸€é”®æ›´æ–°è„šæœ¬

æœåŠ¡å™¨ä¸Šå·²åˆ›å»ºå¿«æ·è„šæœ¬ `~/update.sh`:

```bash
~/update.sh
```

---

## 7. æœåŠ¡å™¨ç®¡ç†å‘½ä»¤

### SSH è¿æ¥

```bash
# é€šè¿‡ Lightsail æ§åˆ¶å°çš„ "Connect using SSH" æŒ‰é’®
# æˆ–ä½¿ç”¨æœ¬åœ°ç»ˆç«¯ï¼š
ssh -i <ä½ çš„å¯†é’¥æ–‡ä»¶> ubuntu@18.139.165.168
```

### PM2 è¿›ç¨‹ç®¡ç†

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs                    # æ‰€æœ‰æ—¥å¿—
pm2 logs mbti-frontend      # åªçœ‹å‰ç«¯
pm2 logs mbti-backend       # åªçœ‹åç«¯
pm2 logs --lines 100        # æœ€è¿‘ 100 è¡Œ

# é‡å¯æœåŠ¡
pm2 restart all             # é‡å¯æ‰€æœ‰
pm2 restart mbti-frontend   # åªé‡å¯å‰ç«¯
pm2 restart mbti-backend    # åªé‡å¯åç«¯

# åœæ­¢/å¯åŠ¨
pm2 stop all
pm2 start all

# ç›‘æ§èµ„æºä½¿ç”¨
pm2 monit
```

### Nginx ç®¡ç†

```bash
# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯
sudo systemctl restart nginx

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status nginx

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
sudo tail -f /var/log/nginx/access.log
```

### ç³»ç»Ÿç®¡ç†

```bash
# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
df -h

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
free -h

# æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½
htop

# é‡å¯æœåŠ¡å™¨ (è°¨æ…ä½¿ç”¨)
sudo reboot
```

---

## 8. ç¯å¢ƒå˜é‡é…ç½®

### åç«¯ (`backend/.env`)

```env
# ç”Ÿäº§ç¯å¢ƒ
DEBUG=false

# AI æœåŠ¡ (å¿…å¡«)
GEMINI_API_KEY=your_gemini_api_key_here

# æ•°æ®åº“ (é»˜è®¤ SQLite)
DATABASE_URL=sqlite+aiosqlite:///./mbti_assistant.db
```

### å‰ç«¯ (`frontend/.env.local`)

```env
# ç”Ÿäº§ç¯å¢ƒ API åœ°å€
NEXT_PUBLIC_API_URL=https://trueself16.com
```

### é‡è¦æé†’

âš ï¸ `.env` å’Œ `.env.local` æ–‡ä»¶åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œ**ä¸è¦æäº¤åˆ° Git**ï¼  
å·²åœ¨ `.gitignore` ä¸­é…ç½®å¿½ç•¥ã€‚

---

## 9. API æ¥å£æ¦‚è§ˆ

### èŠå¤© API (`/api/chat`)

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| POST | `/start` | å¼€å§‹æ–°ä¼šè¯ |
| POST | `/message` | å‘é€æ¶ˆæ¯ |
| POST | `/finish` | å®Œæˆæµ‹è¯•ï¼Œè·å–ç»“æœ |
| POST | `/upgrade` | å‡çº§åˆ°æ›´æ·±å±‚æ¬¡ |
| POST | `/qa` | AI é—®ç­” |
| POST | `/image` | ç”Ÿæˆå¤´åƒ |
| GET | `/history/{session_id}` | è·å–èŠå¤©å†å² |
| GET | `/status/{session_id}` | è·å–ä¼šè¯çŠ¶æ€ |

### åˆ†æ API (`/api/analytics`)

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| POST | `/profile` | åˆ›å»ºç”¨æˆ·æ¡£æ¡ˆ |
| POST | `/event` | è®°å½•äº‹ä»¶ |
| POST | `/feedback` | æäº¤åé¦ˆ |
| GET | `/stats` | è·å–ç»Ÿè®¡æ•°æ® |

### å¥åº·æ£€æŸ¥

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| GET | `/` | API ä¿¡æ¯ |
| GET | `/health` | å¥åº·çŠ¶æ€ |
| GET | `/docs` | Swagger æ–‡æ¡£ |

---

## 10. æ•…éšœæ’æŸ¥

### ç½‘ç«™æ— æ³•è®¿é—®

1. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**
   ```bash
   pm2 status
   sudo systemctl status nginx
   ```

2. **æ£€æŸ¥æ—¥å¿—**
   ```bash
   pm2 logs --lines 50
   sudo tail -f /var/log/nginx/error.log
   ```

3. **é‡å¯æ‰€æœ‰æœåŠ¡**
   ```bash
   pm2 restart all
   sudo systemctl restart nginx
   ```

### API è¿”å›é”™è¯¯

1. **æ£€æŸ¥åç«¯æ—¥å¿—**
   ```bash
   pm2 logs mbti-backend --lines 100
   ```

2. **æ£€æŸ¥ Gemini API Key**
   ```bash
   cat ~/TrueSelfMBTI/backend/.env
   ```

3. **æµ‹è¯• API æ˜¯å¦æ­£å¸¸**
   ```bash
   curl http://127.0.0.1:8000/health
   ```

### å‰ç«¯é¡µé¢ç©ºç™½

1. **æ£€æŸ¥å‰ç«¯æ˜¯å¦æ„å»ºæˆåŠŸ**
   ```bash
   cd ~/TrueSelfMBTI/frontend
   pnpm build
   ```

2. **æ£€æŸ¥ç¯å¢ƒå˜é‡**
   ```bash
   cat ~/TrueSelfMBTI/frontend/.env.local
   ```

3. **é‡å¯å‰ç«¯**
   ```bash
   pm2 restart mbti-frontend
   ```

### å†…å­˜ä¸è¶³ (æ„å»ºå¤±è´¥)

1. **æ£€æŸ¥ Swap æ˜¯å¦å¯ç”¨**
   ```bash
   free -h
   ```

2. **å¦‚æœ Swap ä¸º 0ï¼Œé‡æ–°é…ç½®**
   ```bash
   sudo fallocate -l 2G /swapfile
   sudo chmod 600 /swapfile
   sudo mkswap /swapfile
   sudo swapon /swapfile
   ```

### SSL è¯ä¹¦é—®é¢˜

åŸŸåä½¿ç”¨ Cloudflare Flexible SSLï¼Œè¯ä¹¦ç”± Cloudflare ç®¡ç†ï¼Œæ— éœ€æ‰‹åŠ¨æ›´æ–°ã€‚

å¦‚é‡ HTTPS é—®é¢˜ï¼š
1. ç™»å½• Cloudflare Dashboard
2. æ£€æŸ¥ SSL/TLS è®¾ç½®æ˜¯å¦ä¸º "Flexible"
3. æ£€æŸ¥ DNS è®°å½•æ˜¯å¦æ­£ç¡®

---

## ğŸ“ å¿«é€Ÿå‚è€ƒ

### å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
pm2 status

# æ›´æ–°ä»£ç å¹¶é‡å¯
cd ~/TrueSelfMBTI && git pull && cd frontend && pnpm build && pm2 restart all

# æŸ¥çœ‹æœ€è¿‘æ—¥å¿—
pm2 logs --lines 50

# æµ‹è¯• API
curl https://trueself16.com/health
```

### é‡è¦æ–‡ä»¶ä½ç½®

| æ–‡ä»¶ | è·¯å¾„ |
|------|------|
| é¡¹ç›®ä»£ç  | `~/TrueSelfMBTI/` |
| PM2 é…ç½® | `~/TrueSelfMBTI/ecosystem.config.js` |
| Nginx é…ç½® | `/etc/nginx/sites-available/mbti` |
| åç«¯ç¯å¢ƒå˜é‡ | `~/TrueSelfMBTI/backend/.env` |
| å‰ç«¯ç¯å¢ƒå˜é‡ | `~/TrueSelfMBTI/frontend/.env.local` |
| SQLite æ•°æ®åº“ | `~/TrueSelfMBTI/backend/mbti_assistant.db` |

---

**æœ€åæ›´æ–°**: 2026å¹´1æœˆ4æ—¥  
**ç»´æŠ¤è€…**: Minchen Li


